curl -X POST -H 'Content-Type: application/json' -H 'Content-Length: 2643' -d '{ "$schema" : "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",  "contentVersion" : "1.0.0.0", "parameters" : { "location" : {      "type" : "string",      "metadata" : {        "description" : "Location to deploy"      }    }  },  "variables" : {    "loadBalancerName" : "azure1-st1-d1",    "virtualNetworkName" : "vnet-azure1-westus",    "publicIPAddressName" : "pip-azure1-st1-d1",    "publicIPAddressType" : "Dynamic",    "loadBalancerFrontEnd" : "fe-azure1-st1-d1",    "dnsNameForLBIP" : "dns-azure1-st1-d1",    "ipConfigName" : "ipc-azure1-st1-d1",    "loadBalancerID" : "[resourceID('Microsoft.Network/loadBalancers', variables ('loadBalancerName'))]",    "publicIPAddressID" : "[resourceID('Microsoft.Network/publicIPAddresses',variables('publicIPAddressName'))]",    "frontEndIPConfig" : "[concat(variables('loadBalancerID'),'/frontendIPConfigurations/',variables('loadBalancerFrontEnd'))]"  }, "resources" : [ {    "apiVersion" : "2015-05-01-preview",    "name" : "[variables('publicIPAddressName')]",    "type" : "Microsoft.Network/publicIPAddresses",    "location" : "[parameters('location')]",    "tags" : null,    "properties" : {      "publicIPAllocationMethod" : "[variables('publicIPAddressType')]",      "dnsSettings" : {        "domainNameLabel" : "[variables('dnsNameForLBIP')]"      }    }  }, {    "apiVersion" :"2015-05-01-preview",    "name" : "[variables('loadBalancerName')]",    "type" : "Microsoft.Network/loadBalancers",    "location" :"[parameters('location')]",    "tags" : {      "appName" : "azure1",      "stack" : "st1",      "detail" : "d1"    },    "dependsOn" :[ "[concat('Microsoft.Network/publicIPAddresses/',variables('publicIPAddressName'))]" ],    "properties" : {      "frontEndIPConfigurations" : [ {        "name" : "[variables('loadBalancerFrontEnd')]",        "properties" : {          "publicIPAddress" : {            "id" : "[variables('publicIPAddressID')]"          }        }      } ],      "loadBalancingRules" : [ {        "name" : "lbRule1",        "properties" : {          "frontendIPConfiguration" : {            "id" : "[variables('frontEndIPConfig')]"          },          "protocol" : "tcp",          "frontendPort" : 80,          "backendPort" : 80,          "probe" : {            "id" : "[concat(variables('loadBalancerID'),'/probes/healthcheck1')]"          }        }      } ],      "probes" : [ {        "properties" : {          "protocol" : "http",          "port" : 7001,          "intervalInSeconds" : 10,          "requestPath" : "/healthcheck",          "numberOfProbes" : 2        },        "name" : "healthcheck1"      } ]    }  } ]}' https://management.azure.com/subscriptions/3557e83a-4f9f-490d-b681-90ab48e42182/providers/Microsoft.Network/loadBalancers?api-version=2015-05-01-preview

